<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script src="https://unpkg.com/blockly/blockly_compressed.js"></script>
    <script src="https://unpkg.com/blockly/javascript_compressed.js"></script>
    <script>
        function runBlockly() {
          var code = Blockly.JavaScript.workspaceToCode(workspace);
          FlutterBlockly.postMessage(code);
        }
    </script>
    <style>
        html, body { height: 100%; margin: 0; }
        #blocklyDiv { height: 100%; width: 100%; }
    </style>
</head>
<body>
<div id="blocklyDiv"></div>
<script>
    var workspace = Blockly.inject('blocklyDiv', {
      toolbox: `<xml>
                  <block type="controls_repeat_ext"></block>
                  <block type="math_number"></block>
                  <block type="text"></block>
                  <block type="text_print"></block>
                </xml>`
    });

    function extractCode() {
      var code = Blockly.JavaScript.workspaceToCode(workspace);
      window.FlutterBlockly.postMessage(code);
    }

    workspace.addChangeListener(() => extractCode());
</script>
</body>
</html>
